import{api,setCsrfToken}from"../api.js";import{hideHeader}from"../header.js";import{icon,Icons}from"../icons.js";export function registerRegister(e){e("/register",(e=>{hideHeader(),e.innerHTML=`\n      <div class="auth-container">\n        <div class="auth-wrapper">\n          <div class="card auth-card">\n            \n            <div class="auth-header">\n              <h1 class="auth-logo">S-Store</h1>\n              <p class="text-muted">Create your account</p>\n            </div>\n            \n            <form id="register-form" class="form">\n              <div class="form-group">\n                <label class="label" for="email">Email Address</label>\n                <input \n                  type="email" \n                  id="email" \n                  name="email" \n                  class="input" \n                  placeholder="name@example.com"\n                  autocomplete="email"\n                  required>\n              </div>\n\n              <div class="form-group">\n                <label class="label" for="username">Username</label>\n                <input \n                  type="text" \n                  id="username" \n                  name="username" \n                  class="input" \n                  placeholder="Choose a username"\n                  autocomplete="username"\n                  required>\n              </div>\n              \n              <div class="form-group">\n                <label class="label" for="firstName">First Name (Optional)</label>\n                <input \n                  type="text" \n                  id="firstName" \n                  name="firstName" \n                  class="input" \n                  placeholder="John"\n                  autocomplete="given-name">\n              </div>\n\n              <div class="form-group">\n                <label class="label" for="lastName">Last Name (Optional)</label>\n                <input \n                  type="text" \n                  id="lastName" \n                  name="lastName" \n                  class="input" \n                  placeholder="Doe"\n                  autocomplete="family-name">\n              </div>\n              \n              <div class="form-group">\n                <label class="label" for="password">Password</label>\n                <div class="input-with-actions">\n                  <input \n                    type="password" \n                    id="password" \n                    name="password" \n                    class="input" \n                    placeholder="••••••••"\n                    autocomplete="new-password"\n                    minlength="12"\n                    required>\n                  <button type="button" class="input-action-btn" id="toggle-password" aria-label="Toggle password visibility">\n                    ${icon(Icons.EYE,"icon")}\n                  </button>\n                </div>\n                <p class="form-hint">\n                  Password must be at least 12 characters with uppercase, lowercase, and digits\n                </p>\n              </div>\n\n              <div class="form-group">\n                <label class="label" for="confirmPassword">Confirm Password</label>\n                <input \n                  type="password" \n                  id="confirmPassword" \n                  name="confirmPassword" \n                  class="input" \n                  placeholder="••••••••"\n                  autocomplete="new-password"\n                  minlength="12"\n                  required>\n              </div>\n              \n              <div id="register-error" class="error hidden"></div>\n              \n              <button type="submit" class="btn btn-primary btn-block">Create Account</button>\n            </form>\n            \n            <div class="auth-footer">\n              <p class="text-muted">Already have an account? <a href="#/login" class="link">Sign in</a></p>\n            </div>\n          </div>\n\n          <div class="auth-theme-toggle">\n            <button class="btn btn-icon" id="auth-theme-toggle" aria-label="Toggle theme">${getThemeIcon()}</button>\n          </div>\n        \n        </div>\n      </div>`;const t=e.querySelector("#register-form"),n=e.querySelector("#register-error"),a=e.querySelector("#auth-theme-toggle"),s=e.querySelector("#password"),o=e.querySelector("#toggle-password");a&&a.addEventListener("click",(()=>{const e=document.documentElement,t="light"===e.getAttribute("data-theme")?"dark":"light";e.setAttribute("data-theme",t),localStorage.setItem("theme",t),a.innerHTML=getThemeIcon()})),o&&s&&o.addEventListener("click",(()=>{const e="password"===s.type;s.type=e?"text":"password",o.innerHTML=icon(e?Icons.EYE_OFF:Icons.EYE,"icon")})),t.addEventListener("submit",(async e=>{e.preventDefault(),n.classList.add("hidden"),n.textContent="";const a=new FormData(t),s=a.get("password")?.toString()||"";if(s!==(a.get("confirmPassword")?.toString()||""))return n.textContent="Passwords do not match",void n.classList.remove("hidden");if(s.length<12)return n.textContent="Password must be at least 12 characters long",void n.classList.remove("hidden");if(!/[A-Z]/.test(s))return n.textContent="Password must contain at least one uppercase letter",void n.classList.remove("hidden");if(!/[a-z]/.test(s))return n.textContent="Password must contain at least one lowercase letter",void n.classList.remove("hidden");if(!/[0-9]/.test(s))return n.textContent="Password must contain at least one digit",void n.classList.remove("hidden");const o={email:a.get("email")?.toString()||"",username:a.get("username")?.toString()||"",password:s,firstName:a.get("firstName")?.toString()||void 0,lastName:a.get("lastName")?.toString()||void 0};try{const e=await api("/auth/register",{method:"POST",body:o});e?.csrfToken&&setCsrfToken(e.csrfToken),alert(e.message||"Registration successful! Please check your email to verify your account."),location.hash="/verify-email"}catch(e){const t=e;n.textContent=t.message||"Registration failed. Please try again.",n.classList.remove("hidden")}}))}))}function getThemeIcon(){const e=document.documentElement.getAttribute("data-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return icon("dark"===(e||t)?Icons.SUN:Icons.MOON,"icon icon-lg")}