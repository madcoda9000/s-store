import{api,setCsrfToken}from"../api.js";import{hideHeader}from"../header.js";export function registerLogin(e){e("/login",(e=>{hideHeader(),e.innerHTML='\n      <div class="auth-container">\n        <div class="auth-wrapper">\n          <div class="card auth-card">\n            \n            <div class="auth-header">\n              <h1 class="auth-logo">S-Store</h1>\n              <p class="text-muted">Sign in to your account</p>\n            </div>\n            \n            <form id="login-form" class="form">\n              <div class="form-group">\n                <label class="label" for="username">Email or Username</label>\n                <input \n                  type="text" \n                  id="username" \n                  name="username" \n                  class="input" \n                  placeholder="name@example.com"\n                  autocomplete="username"\n                  required>\n              </div>\n              \n              <div class="form-group">\n                <label class="label" for="password">Password</label>\n                <input \n                  type="password" \n                  id="password" \n                  name="password" \n                  class="input" \n                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"\n                  autocomplete="current-password"\n                  required>\n              </div>\n              \n              <div class="form-group form-row">\n                <label class="checkbox">\n                  <input type="checkbox" name="remember">\n                  <span>Remember me</span>\n                </label>\n                <a href="#/forgot-password" class="link">Forgot password?</a>\n              </div>\n              \n              <div id="login-error" class="error hidden"></div>\n              \n              <button type="submit" class="btn btn-primary btn-block">Sign In</button>\n            </form>\n            \n            <div class="auth-footer">\n              <p class="text-muted">Don\'t have an account? <a href="#/register" class="link">Sign up</a></p>\n            </div>\n          </div>\n\n          <div class="auth-theme-toggle">\n            <button class="btn btn-icon" id="theme-toggle" aria-label="Toggle theme">ðŸŒ“</button>\n          </div>\n        \n        </div>\n      </div>';const n=e.querySelector("#login-form"),t=e.querySelector("#login-error"),a=e.querySelector("#auth-theme-toggle");a&&a.addEventListener("click",(()=>{const e=document.documentElement,n="light"===e.getAttribute("data-theme")?"dark":"light";e.setAttribute("data-theme",n),localStorage.setItem("theme",n)})),n.addEventListener("submit",(async e=>{e.preventDefault(),t.classList.add("hidden"),t.textContent="";const a=new FormData(n),r={username:a.get("username")?.toString()||"",password:a.get("password")?.toString()||"",rememberMe:"on"===a.get("remember")};try{const e=await api("/auth/login",{method:"POST",body:r});e?.csrfToken&&setCsrfToken(e.csrfToken),location.hash=e?.requires2fa?"/2fa":"/home"}catch(e){const n=e;t.textContent=n.message||"Invalid credentials",t.classList.remove("hidden")}}))}))}