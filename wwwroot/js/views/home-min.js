import{api}from"../api.js";import{updateHeader}from"../header.js";export function registerHome(a){a("/home",(async a=>{try{const s=await api("/auth/me");updateHeader(s);const e=s.roles&&s.roles.includes("Admin");a.innerHTML=`\n        <div class="section">\n          <div class="section-header">\n            <h2 class="section-title mb-0">Welcome, ${escapeHtml(s.userName)}!</h2>\n          </div>\n          \n          <div class="grid">\n            <div class="card">\n              <div class="card-title">Profile Status</div>\n              <div class="stat">${s.twoFactorEnabled?"üîê":"‚ö†Ô∏è"}</div>\n              <p class="text-muted">\n                ${s.twoFactorEnabled?"Two-factor authentication is enabled":"Two-factor authentication is disabled"}\n              </p>\n              ${s.twoFactorEnabled?"":'<a href="#/setup-2fa" class="btn btn-primary">Setup 2FA</a>'}\n            </div>\n            \n            ${e?'\n            <div class="card">\n              <div class="card-title">Administration</div>\n              <div class="stat">‚öôÔ∏è</div>\n              <p class="text-muted">Manage users and system settings</p>\n              <a href="#/admin/users" class="btn btn-primary">Manage Users</a>\n            </div>\n            ':""}\n            \n            <div class="card">\n              <div class="card-title">Your Account</div>\n              <div class="stat">üë§</div>\n              <p class="text-muted">View and edit your profile settings</p>\n              <a href="#/profile" class="btn btn-primary">Edit Profile</a>\n            </div>\n          </div>\n        </div>\n      `}catch(s){const e=s;if(e.message.includes("Unauthorized")||e.message.includes("401"))return void(location.hash="/login");a.innerHTML=`\n        <div class="section">\n          <div class="alert alert-danger">\n            <strong>Error:</strong> ${escapeHtml(e.message||"Failed to load home page")}\n          </div>\n        </div>\n      `}}))}function escapeHtml(a){return a?a.replace(/[&<>"']/g,(a=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[a]))):""}